var g=Object.defineProperty;var u=(r,a,e)=>a in r?g(r,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[a]=e;var n=(r,a,e)=>(u(r,typeof a!="symbol"?a+"":a,e),e);import{c as p}from"./assets/signals-DHVSGanU.js";class m extends HTMLElement{constructor(){super();n(this,"shadow");n(this,"actionForm");this.shadow=this.attachShadow({mode:"open"});const e=this.closest("action-form");e&&e.steps.all.length>0&&(this.actionForm=e,this.shadow.addEventListener("click",t=>{const s=t.target;if(this.actionForm&&s instanceof HTMLButtonElement&&s.matches(".step")&&!s.disabled){const i=Number(s.dataset.index||0);e.steps.set(i)}}),p(()=>{const t=e.steps.stepsLength(),s=e.steps.stepIndex();console.log("ðŸ«¨ create effect: af-progress: rerender",t,s),this.render(t,s)}))}render(e,t){const s=t/(e-1)*100,i="<style>:host{display:grid;position:relative;align-items:center;--step-border-size:.22em;--step-bg:white;--step-text:inherit;--inactive:lightgray;--active:lightseagreen;--invalid:coral;--valid:var(--active);--valid-bg:var(--active);--valid-text:white}.progress{background:var(--active);height:.5em;grid-row:-1/1;grid-column:-1/1}nav{margin:0;padding:0;list-style:none;display:flex;justify-content:space-between;grid-row:-1/1;grid-column:-1/1}.bg{background:var(--inactive);height:.5em;grid-row:-1/1;grid-column:-1/1}.step{border:var(--step-border-size) solid var(--inactive);border-radius:100%;width:2em;height:2em;line-height:1.65em;text-align:center;background:var(--step-bg);font-size:.9em;position:relative;z-index:1;padding:0;margin:0;cursor:pointer;color:var(--step-text)}.valid:has(~ .active){border-color:var(--valid);background:var(--valid-bg);color:var(--valid-text)}.step:disabled{opacity:1;cursor:not-allowed}.active{border-color:var(--active)}.step:not(.valid):has(~ .active){border-color:var(--invalid)}</style>";this.shadow.innerHTML=`${i}
        <div class="bg" part="bg"></div>
        <div class="progress" part="progress" style="width: ${s}%;"></div>
        <nav part="nav">
        ${Array.from(this.actionForm.steps.getVisible()).map((o,l)=>{const c=l===t?"active":"",d=o.valid?"valid":"",h=this.hasAttribute("enable-all")||t>l?"":"disabled",v=o.dataset.title||"";return`<button type="button" part="step ${d} ${c}" ${h} title="${v}" class="step ${d} ${c}" ${c&&'aria-current="step"'} aria-label="Step ${l+1}" data-index="${l}">${l+1}</button>`}).join("")}
        </nav>
        `}}class b extends HTMLElement{constructor(){super();n(this,"shadow");n(this,"DOM");n(this,"actionForm");const e=this.closest("action-form");if(e&&e.steps.all.length>0){this.actionForm=e;const t=this.attachInternals();this.shadow=t.shadowRoot,this.DOM=this.shadow||this,this.DOM.addEventListener("change",()=>{this.valid=this.isValid}),this.DOM.addEventListener("click",s=>{const i=s.target;i instanceof HTMLButtonElement&&(i.dataset.direction==="next"||i.dataset.direction==="prev")&&this.step(i.dataset.direction)}),p(()=>{console.log("ðŸ«¨ create effect: af-step: update button text"),e.steps.stepsLength(),this.setButtonTexts()})}}get valid(){return this.hasAttribute("valid")}set valid(e){e?this.setAttribute("valid",""):this.removeAttribute("valid")}get isValid(){return this.querySelectorAll(":invalid").length===0}getStepTitle(e){var s;let t=e==="next"?this.nextElementSibling:this.previousElementSibling;return t&&t instanceof HTMLElement&&t.style.display==="none"&&(t=e==="next"?t.nextElementSibling:t.previousElementSibling),t&&t.matches("af-step")?t.dataset.title||((s=this.actionForm)==null?void 0:s.dataset[e])||e.replace(/^\w/,i=>i.toUpperCase()):""}get submit(){var e;return((e=this.actionForm)==null?void 0:e.dataset.submit)||"Submit"}step(e="next"){var t;(t=this.actionForm)==null||t.steps[e]()}connectedCallback(){if(this.valid=this.isValid,!(this.DOM.querySelector("slot[name=footer]")||this.DOM.querySelector("[slot=footer]"))){const t=document.createElement("nav");t.classList.add("af-step-nav"),t.setAttribute("part","step-nav"),t.setAttribute("aria-label","Step Navigation");const s=(i="next")=>{const o=this.getStepTitle(i);return o?`<button type="button" class="af-step-${i}" data-direction="${i}" part="step-btn ${i}">${o}</button>`:i==="next"?`<button type="submit" part="submit">${this.submit}</button>`:"<span></span>"};t.innerHTML=`${s("prev")}${s("next")}`,this.DOM.appendChild(t)}}setButtonTexts(){this.DOM.querySelectorAll("button[data-direction]").forEach(t=>{(t.dataset.direction==="next"||t.dataset.direction==="prev")&&(t.textContent=this.getStepTitle(t.dataset.direction))})}}customElements.define("af-step",b);customElements.define("af-progress",m);
//# sourceMappingURL=af-step.js.map
