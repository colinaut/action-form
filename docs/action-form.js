var r=Object.defineProperty;var l=(i,a,e)=>a in i?r(i,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[a]=e;var h=(i,a,e)=>(l(i,typeof a!="symbol"?a+"":a,e),e);class u extends HTMLElement{constructor(){super();h(this,"form",this.querySelector("form"));h(this,"stepIndex",0);h(this,"fieldsets",this.querySelectorAll("fieldset, af-step"));h(this,"formElements",this.querySelectorAll("input, select, textarea"));document.documentElement.classList.add("js"),this.form&&(this.hasAttribute("novalidate")&&this.form.setAttribute("novalidate",""),this.setAttribute("loaded",""),this.enhanceFieldsets(),this.steps.forEach((e,s)=>{s===0&&e.setAttribute("active","")}),this.addEventListener("af-step",e=>{var o,n;const s=e;console.log("af-step",(o=s.detail)==null?void 0:o.step),((n=s.detail)==null?void 0:n.step)!==void 0&&(this.stepIndex=s.detail.step,this.steps.forEach((c,t)=>{c.active&&(c.completed=c.valid),c.active=t===this.stepIndex}))}))}get steps(){return this.querySelectorAll("af-step:not([hidden])")}enhanceFieldsets(){this.fieldsets.forEach(e=>{const s=e.dataset.watch,o=e.dataset.value,n=e.dataset.regex;if(s){const c=Array.from(this.formElements).filter(t=>t.name.toLowerCase()===s.toLowerCase());if(c.length===0)return;console.log(e.name,"watching",s,c),c.forEach(t=>{t.addEventListener("change",()=>{!o&&!n?(console.log("change no value",t.value),this.show(e,t.checkValidity())):t instanceof HTMLInputElement&&["checkbox","radio"].includes(t.type)?(console.log("change checkbox",t.value),this.checkMatches(t.value,o,n)&&this.show(e,t.checked)):(console.log("change else",t.value),this.show(e,this.checkMatches(t.value,o,n))),e.matches("af-step")&&this.dispatchEvent(new CustomEvent("af-step"))})})}})}checkMatches(e,s="",o){return o?new RegExp(o).test(e):s===e}show(e,s){s?(e.removeAttribute("hidden"),e.removeAttribute("disabled")):(e.setAttribute("hidden",""),e.setAttribute("disabled",""))}connectedCallback(){console.log("connected")}}customElements.define("action-form",u);
//# sourceMappingURL=action-form.js.map
