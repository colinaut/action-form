var m=Object.defineProperty;var u=(c,r,e)=>r in c?m(c,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[r]=e;var l=(c,r,e)=>(u(c,typeof r!="symbol"?r+"":r,e),e);class p extends HTMLElement{constructor(){super();l(this,"stepIndex",0);l(this,"watchers",[]);document.documentElement.classList.add("js");const e=this.querySelector("form");e&&(this.hasAttribute("novalidate")&&e.setAttribute("novalidate",""),this.steps.forEach((s,t)=>{s.setAttribute("index",String(t)),t===0&&(s.classList.add("active"),s.classList.add("first")),t===this.steps.length-1&&s.classList.add("last")}),this.addEventListener("af-step",s=>{var n,a,o,d;const t=s;console.log("af-step",(n=t.detail)==null?void 0:n.step);let i=this.stepIndex;typeof((a=t.detail)==null?void 0:a.step)=="number"?i=t.detail.step:((o=t.detail)==null?void 0:o.direction)==="next"?i++:((d=t.detail)==null?void 0:d.direction)==="prev"&&i--,i=Math.max(0,Math.min(i,this.steps.length-1)),this.stepIndex=i,Array.from(this.steps).filter(h=>!h.hidden).forEach((h,f)=>{f===this.stepIndex?h.classList.add("active"):h.classList.remove("active")})}),this.enhanceElements(),this.addEventListener("change",s=>{const t=s.target;if(t instanceof HTMLElement&&t.matches("input, textarea, select, af-group-count")){const i=t,n=i.getAttribute("aria-describedby");if(n){const a=document.getElementById(n);if(a!=null&&a.matches("af-error")){const o=a,d=i.checkValidity();o.showError(!d)}}}this.checkWatchers()}))}checkWatchers(){const e=this.querySelector("form");if(!e||this.watchers.length===0)return;const s=new FormData(e);this.watchers.forEach(t=>{const n=s.getAll(t.name).some(a=>typeof a=="string"&&(a===t.value||t.regex&&t.regex.test(a)));t.el.hasAttribute("hidden")===n&&(this.show(t.el,n),t.el.matches("af-step")&&this.dispatchEvent(new CustomEvent("af-step")))})}get steps(){return this.querySelectorAll("af-step")}enhanceElements(){this.querySelectorAll("[data-watch]").forEach(s=>{const t=s.dataset.watch,i=s.dataset.value,n=s.dataset.regex,a=n?new RegExp(n):!n&&!i?/./:void 0;t&&this.watchers.push({name:t,value:i,regex:a,el:s})}),this.checkWatchers()}show(e,s){s?(e.removeAttribute("hidden"),e.removeAttribute("disabled")):(e.setAttribute("hidden",""),e.setAttribute("disabled","")),e.dispatchEvent(new CustomEvent("af-watcher",{bubbles:!0,detail:{show:s}}))}}customElements.define("action-form",p);
//# sourceMappingURL=action-form.js.map
