var m=Object.defineProperty;var f=(d,o,s)=>o in d?m(d,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):d[o]=s;var l=(d,o,s)=>(f(d,typeof o!="symbol"?o+"":o,s),s);class p extends HTMLElement{constructor(){super();l(this,"stepIndex",0);l(this,"watchers",[]);document.documentElement.classList.add("js");const s=this.querySelector("form");s&&(this.hasAttribute("novalidate")&&s.setAttribute("novalidate",""),this.steps.forEach((r,t)=>{r.setAttribute("index",String(t)),t===0&&r.classList.add("first","active"),t===this.steps.length-1&&r.classList.add("last")}),this.addEventListener("af-step",r=>{var i,a,c,n;const t=r;console.log("af-step",(i=t.detail)==null?void 0:i.step);let e=this.stepIndex;typeof((a=t.detail)==null?void 0:a.step)=="number"?e=t.detail.step:((c=t.detail)==null?void 0:c.direction)==="next"?e++:((n=t.detail)==null?void 0:n.direction)==="prev"&&e--,e=Math.max(0,Math.min(e,this.steps.length-1)),this.stepIndex=e,Array.from(this.steps).filter(h=>!h.hidden).forEach((h,u)=>{u===this.stepIndex?h.classList.add("active"):h.classList.remove("active")})}),this.hasAttribute("auto-error")&&this.querySelectorAll("[required],[pattern],[type=phone],[type=email],[type=url]").forEach(t=>{var c;let e=t.getAttribute("id")||"";const i=s.querySelector(`af-error[for="${e}"]`),a=(c=t.closest("label"))==null?void 0:c.querySelector("af-error");if(!i&&!a){const n=document.createElement("af-error");n.textContent=t.dataset.error||"",e||(e=`${t.id||t.name||t.tagName.toLowerCase()}-${Math.random().toString(36).substring(2,9)}`,t.setAttribute("id",e)),n.setAttribute("for",e),t.after(n),console.log(`Added Error Message for ${t.tagName.toLowerCase()}[${t.name}] #${e}`)}}),this.enhanceElements(),this.addEventListener("change",r=>{const t=r.target;if(t instanceof HTMLElement&&t.matches("input, textarea, select, af-group-count")){const e=t,i=e.getAttribute("aria-describedby");if(i){const a=document.getElementById(i);if(a!=null&&a.matches("af-error")){const c=a,n=e.checkValidity();c.showError(!n)}}}this.checkWatchers()}))}checkWatchers(){const s=this.querySelector("form");if(!s||this.watchers.length===0)return;const r=new FormData(s);this.watchers.forEach(t=>{const i=r.getAll(t.name).some(a=>typeof a=="string"&&(a===t.value||t.regex&&t.regex.test(a)));t.el.hasAttribute("hidden")===i&&(this.show(t.el,i),t.el.matches("af-step")&&this.dispatchEvent(new CustomEvent("af-step")))})}get steps(){return this.querySelectorAll("af-step")}enhanceElements(){this.querySelectorAll("[data-watch]").forEach(r=>{const t=r.dataset.watch,e=r.dataset.value,i=r.dataset.regex,a=i?new RegExp(i):!i&&!e?/./:void 0;t&&this.watchers.push({name:t,value:e,regex:a,el:r})}),this.checkWatchers()}show(s,r){r?(s.removeAttribute("hidden"),s.removeAttribute("disabled")):(s.setAttribute("hidden",""),s.setAttribute("disabled","")),s.dispatchEvent(new CustomEvent("af-watcher",{bubbles:!0,detail:{show:r}}))}}customElements.define("action-form",p);
//# sourceMappingURL=action-form.js.map
