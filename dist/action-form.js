var f=Object.defineProperty;var u=(c,r,e)=>r in c?f(c,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[r]=e;var h=(c,r,e)=>(u(c,typeof r!="symbol"?r+"":r,e),e);class m extends HTMLElement{constructor(){super();h(this,"stepIndex",0);h(this,"watchers",[]);document.documentElement.classList.add("js");const e=this.querySelector("form");e&&(this.hasAttribute("novalidate")&&e.setAttribute("novalidate",""),this.steps.length>0&&this.steps[0].setAttribute("active",""),this.addEventListener("af-step",s=>{var o,t;const n=s;console.log("af-step",(o=n.detail)==null?void 0:o.step),((t=n.detail)==null?void 0:t.step)!==void 0&&(this.stepIndex=n.detail.step,Array.from(this.steps).filter(i=>!i.hidden).forEach((i,a)=>{i.active=a===this.stepIndex}))}),this.enhanceElements(),this.addEventListener("change",s=>{const n=s.target;if(n instanceof HTMLElement&&n.matches("input, textarea, select, af-group-count")){const t=n,i=t.getAttribute("aria-describedby");if(i){const a=document.getElementById(i);if(a!=null&&a.matches("af-error")){const d=a,l=t.checkValidity();d.showError(!l)}}}const o=new FormData(e);!o||this.watchers.length===0||this.watchers.forEach(t=>{const a=o.getAll(t.name).some(d=>typeof d=="string"&&(d===t.value||t.regex&&t.regex.test(d)));t.el.hasAttribute("hidden")===a&&(this.show(t.el,a),t.el.matches("af-step")&&this.dispatchEvent(new CustomEvent("af-step")))})}))}get steps(){return this.querySelectorAll("af-step")}enhanceElements(){this.querySelectorAll("[data-watch]").forEach(s=>{const n=s.dataset.watch,o=s.dataset.value,t=s.dataset.regex,i=t?new RegExp(t):!t&&!o?/./:void 0;n&&this.watchers.push({name:n,value:o,regex:i,el:s})})}show(e,s){s?(e.removeAttribute("hidden"),e.removeAttribute("disabled")):(e.setAttribute("hidden",""),e.setAttribute("disabled","")),e.dispatchEvent(new CustomEvent("af-watcher",{bubbles:!0,detail:{show:s}}))}}customElements.define("action-form",m);
//# sourceMappingURL=action-form.js.map
