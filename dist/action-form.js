var l=Object.defineProperty;var c=(n,s,e)=>s in n?l(n,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[s]=e;var o=(n,s,e)=>(c(n,typeof s!="symbol"?s+"":s,e),e);class h extends HTMLElement{constructor(){super();o(this,"form",this.querySelector("form"));o(this,"stepIndex",0);o(this,"fieldsets",this.querySelectorAll("fieldset, af-step"));o(this,"formElements",this.querySelectorAll("input, select, textarea"));o(this,"watchers",[]);document.documentElement.classList.add("js"),this.form&&(this.hasAttribute("novalidate")&&this.form.setAttribute("novalidate",""),this.setAttribute("loaded",""),this.enhanceFieldsets(),this.steps.forEach((e,t)=>{t===0&&e.setAttribute("active","")}),this.addEventListener("af-step",e=>{var r,i;const t=e;console.log("af-step",(r=t.detail)==null?void 0:r.step),((i=t.detail)==null?void 0:i.step)!==void 0&&(this.stepIndex=t.detail.step,this.steps.forEach((a,d)=>{a.active&&(a.completed=a.valid),a.active=d===this.stepIndex}))}),this.addEventListener("change",()=>{const e=this.form&&new FormData(this.form);e&&this.watchers.forEach(t=>{const i=e.getAll(t.name).some(a=>typeof a=="string"&&(a===t.value||t.regex&&t.regex.test(a)));t.el.hasAttribute("hidden")===i&&(console.log("watcher",t.name,i),this.show(t.el,i),t.el.matches("af-step")&&this.dispatchEvent(new CustomEvent("af-step")))})}))}get steps(){return this.querySelectorAll("af-step:not([hidden])")}enhanceFieldsets(){this.fieldsets.forEach(e=>{const t=e.dataset.watch,r=e.dataset.value,i=e.dataset.regex?new RegExp(e.dataset.regex):void 0;t&&this.watchers.push({name:t,value:r,regex:i,el:e})})}show(e,t){t?(e.removeAttribute("hidden"),e.removeAttribute("disabled")):(e.setAttribute("hidden",""),e.setAttribute("disabled",""))}connectedCallback(){console.log("connected")}}customElements.define("action-form",h);
//# sourceMappingURL=action-form.js.map
