{"version":3,"file":"af-progress.js","sources":["../src/af-progress.ts"],"sourcesContent":["import type ActionForm from \"./action-form\";\nexport default class ActionFormProgress extends HTMLElement {\n\tprivate shadow: ShadowRoot;\n\tconstructor() {\n\t\tsuper();\n\t\tthis.shadow = this.attachShadow({ mode: \"open\" });\n\n\t\tif (!this.actionForm?.steps) return;\n\n\t\tthis.actionForm.addEventListener(\"af-step\", () => {\n\t\t\tconsole.log(\"af-step listener called\");\n\t\t\tthis.render();\n\t\t});\n\n\t\tthis.render();\n\n\t\tthis.shadow.addEventListener(\"click\", (e) => {\n\t\t\tconst target = e.target;\n\t\t\tif (target instanceof HTMLButtonElement && target.matches(\".step\") && !target.disabled) {\n\t\t\t\tconst step = Number(target.dataset.index || 0);\n\t\t\t\t// dispatch event to action-form which handles show/hide of steps\n\n\t\t\t\tthis.dispatchEvent(new CustomEvent(\"af-step\", { bubbles: true, composed: true, detail: { step } }));\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate actionForm = this.closest(\"action-form\") as ActionForm | null;\n\n\tget stepIndex(): number {\n\t\treturn this.actionForm?.stepIndex || 0;\n\t}\n\n\tprivate render() {\n\t\tif (!this.actionForm?.steps) return;\n\n\t\tconst progressPercentage = (this.stepIndex / (Array.from(this.actionForm.steps).filter((step) => !step.hidden).length - 1)) * 100;\n\n\t\t// TODO: simplify this\n\t\tconst style = `\n        <style>\n        :host {\n            display: grid;\n            position: relative;\n            align-items: center;\n            --step-border-size: .22em;\n            --step-bg: white;\n            --step-text: inherit;\n            --inactive: lightgray;\n            --active: lightseagreen;\n            --invalid: coral;\n            --valid: var(--active);\n            --valid-bg: var(--active);\n            --valid-text: white;\n        }\n        .progress {\n            background: var(--active);\n            height: 0.5em;\n            grid-row: -1/1;\n            grid-column: -1/1;\n        }\n        nav {\n            margin: 0;\n            padding: 0;\n            list-style: none;\n            display: flex;\n            justify-content: space-between;\n            grid-row: -1/1;\n            grid-column: -1/1;\n        }\n        .bg {\n            background: var(--inactive);\n            height: 0.5em;\n            grid-row: -1/1;\n            grid-column: -1/1;\n        }\n        .step {\n            border: var(--step-border-size) solid var(--inactive);\n            border-radius: 100%;\n            width: 2em;\n            height: 2em;\n            line-height: 1.65em;\n            text-align: center;\n            background: var(--step-bg);\n            font-size: 0.9em;\n            position: relative;\n            z-index: 1;\n            padding: 0;\n            margin: 0;\n            cursor: pointer;\n            color: var(--step-text);\n        }\n        .valid:has(~ .active) {\n            border-color: var(--valid);\n            background: var(--valid-bg);\n            color: var(--valid-text);\n        }\n        .step:disabled {\n            opacity: 1;\n            cursor: not-allowed;\n        }\n        .active {\n            border-color: var(--active);\n        }\n        .step:not(.valid):has(~ .active) {\n            border-color: var(--invalid);\n        }\n        </style>\n        `;\n\n\t\t// TODO: add step titles from af-step\n\t\tthis.shadow.innerHTML = `${style}\n        <div class=\"bg\" part=\"bg\"></div>\n        <div class=\"progress\" part=\"progress\" style=\"width: ${progressPercentage}%;\"></div>\n        <nav part=\"nav\">\n        ${Array.from(this.actionForm?.steps)\n\t\t\t.filter((step) => !step.hidden)\n\t\t\t.map((step, index) => {\n\t\t\t\tconst active = index === this.stepIndex ? \"active\" : \"\";\n\t\t\t\tconst valid = step.valid ? \"valid\" : \"\";\n\t\t\t\tconst disabled = this.hasAttribute(\"enable-all\") || this.stepIndex > index ? \"\" : \"disabled\";\n\t\t\t\tconst title = step.getAttribute(\"progress-title\") || \"\";\n\t\t\t\treturn `<button type=\"button\" part=\"step ${valid} ${active}\" ${disabled} title=\"${title}\" class=\"step ${valid} ${active}\" ${\n\t\t\t\t\tactive && `aria-current=\"step\"`\n\t\t\t\t} aria-label=\"Step ${index + 1}\" data-index=\"${index}\">${index + 1}</button>`;\n\t\t\t})\n\t\t\t.join(\"\")}\n        </nav>\n        `;\n\t}\n}\ncustomElements.define(\"af-progress\", ActionFormProgress);\n"],"names":["ActionFormProgress","_a","__publicField","e","target","step","_b","progressPercentage","style","index","active","valid","disabled","title"],"mappings":"wKACA,MAAqBA,UAA2B,WAAY,CAE3D,aAAc,CAFf,IAAAC,EAGQ,QAFCC,EAAA,eA0BAA,EAAA,kBAAa,KAAK,QAAQ,aAAa,GAvB9C,KAAK,OAAS,KAAK,aAAa,CAAE,KAAM,OAAQ,GAE3CD,EAAA,KAAK,aAAL,MAAAA,EAAiB,QAEjB,KAAA,WAAW,iBAAiB,UAAW,IAAM,CACjD,QAAQ,IAAI,yBAAyB,EACrC,KAAK,OAAO,CAAA,CACZ,EAED,KAAK,OAAO,EAEZ,KAAK,OAAO,iBAAiB,QAAUE,GAAM,CAC5C,MAAMC,EAASD,EAAE,OACb,GAAAC,aAAkB,mBAAqBA,EAAO,QAAQ,OAAO,GAAK,CAACA,EAAO,SAAU,CACvF,MAAMC,EAAO,OAAOD,EAAO,QAAQ,OAAS,CAAC,EAG7C,KAAK,cAAc,IAAI,YAAY,UAAW,CAAE,QAAS,GAAM,SAAU,GAAM,OAAQ,CAAE,KAAAC,CAAK,CAAA,CAAG,CAAC,EAClG,KAAK,OAAO,CACb,CAAA,CACA,EACF,CAIA,IAAI,WAAoB,CA7BzB,IAAAJ,EA8BS,QAAAA,EAAA,KAAK,aAAL,YAAAA,EAAiB,YAAa,CACtC,CAEQ,QAAS,CAjClB,IAAAA,EAAAK,EAkCM,GAAA,GAACL,EAAA,KAAK,aAAL,MAAAA,EAAiB,OAAO,OAE7B,MAAMM,EAAsB,KAAK,WAAa,MAAM,KAAK,KAAK,WAAW,KAAK,EAAE,OAAQF,GAAS,CAACA,EAAK,MAAM,EAAE,OAAS,GAAM,IAGxHG,EAAQ,mgCAwET,KAAA,OAAO,UAAY,GAAGA,CAAK;AAAA;AAAA,8DAE4BD,CAAkB;AAAA;AAAA,UAEtE,MAAM,MAAKD,EAAA,KAAK,aAAL,YAAAA,EAAiB,KAAK,EACvC,OAAQD,GAAS,CAACA,EAAK,MAAM,EAC7B,IAAI,CAACA,EAAMI,IAAU,CACrB,MAAMC,EAASD,IAAU,KAAK,UAAY,SAAW,GAC/CE,EAAQN,EAAK,MAAQ,QAAU,GAC/BO,EAAW,KAAK,aAAa,YAAY,GAAK,KAAK,UAAYH,EAAQ,GAAK,WAC5EI,EAAQR,EAAK,aAAa,gBAAgB,GAAK,GAC9C,MAAA,oCAAoCM,CAAK,IAAID,CAAM,KAAKE,CAAQ,WAAWC,CAAK,iBAAiBF,CAAK,IAAID,CAAM,KACtHA,GAAU,qBACX,qBAAqBD,EAAQ,CAAC,iBAAiBA,CAAK,KAAKA,EAAQ,CAAC,WAAA,CAClE,EACA,KAAK,EAAE,CAAC;AAAA;AAAA,SAGX,CACD,CACA,eAAe,OAAO,cAAeT,CAAkB"}